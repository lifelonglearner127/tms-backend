{% if is_finished %}
  {{ result }}
{% else %}
  {% if not is_started %}
  <a href="{% url 'security:app-test' test.id %}?start=1&username={{username}}&token={{token}}">Start Test</a>
  {% else %}
    <form action="{% url 'security:answer-question' test.id question.id %}?start=1&username={{username}}&token={{token}}" method="post" onsubmit="return validateForm()">
      {% csrf_token %}
      <h3>{{ question.question | safe }}</h3>
      {% if question.question_type == 0 %}
        <input type="radio" name="answers" value="1">True
        <input type="radio" name="answers" value="0">False
      {% elif question.question_type == 1 %}
        {% for choice in question.choices %}
          <input type="radio" name="answers" value="{{ forloop.counter0 }}"> {{ choice }} <br>
        {% endfor %}
      {% else %}
        {% for choice in question.choices %}
          <input type="checkbox" name="answers" value="{{ forloop.counter0 }}"> {{ choice }} <br>
        {% endfor %}
      {% endif %}
      <p id="error-msg"></p>
      <input type="hidden" name="username" value="{{username}}">
      <input type="submit" value="Vote">
    </form>
  {% endif %}
{% endif %}

<script>
function validateForm() {
  var checkboxes = document.getElementsByName("answers");
  var numberOfCheckedItems = 0;
  for(var i = 0; i < checkboxes.length; i++)
  {
    if(checkboxes[i].checked)
      numberOfCheckedItems++;
  }
  if (numberOfCheckedItems == 0) {
    document.getElementById('error-msg').innerHTML = '请选择一个选项';
    return false;
  }
  return true
}
</script>